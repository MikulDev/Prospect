plugins {
    id 'java'
    id 'application'
    id 'org.openjfx.javafxplugin' version '0.1.0'
    id 'com.gluonhq.gluonfx-gradle-plugin' version '1.0.23'
}

repositories {
    mavenCentral()
    maven { url 'https://nexus.gluonhq.com/nexus/content/repositories/releases' }
}

apply from: 'dependencies.gradle'

dependencies {
    implementation files('lib/windows/MtpJava-1.0-SNAPSHOT.jar')
}

javafx {
    version = '21'
    modules = [ 'javafx.controls', 'javafx.fxml' ]
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}

sourceSets {
    main {
        java.srcDirs = ['src/main/java', 'src/windows/java']
    }
}

gluonfx {
    target = 'host'
    appIdentifier = 'com.momosoftworks.prospect'

    attachConfig {
        version = '4.0.23'
        services 'display', 'lifecycle', 'statusbar', 'storage', 'pictures'
    }

    resourcesList = [
            "com/github/hms11rn/mtp/.*"
    ]

    reflectionList = [
            "com.momosoftworks.prospect.report.Report",
            "com.momosoftworks.prospect.report.template.Template",
            "com.momosoftworks.prospect.report.element.TextFieldElement",
            "com.momosoftworks.prospect.report.template.element.TextFieldTemplate",
            "file_transfer.WindowsMTPHandler",
            "com.github.hms11rn.mtp.PortableDeviceManager",
            "com.github.hms11rn.mtp.PortableDevice",
            "com.github.hms11rn.mtp.content.PortableDeviceContainerObject",
            "com.github.hms11rn.mtp.content.PortableDeviceObject"
    ]

    bundlesList = ["com.momosoftworks.prospect.resources.prospect", "fontmanager"]
}

ext {
    manifest = file('src/android/AndroidManifest.xml')
    compileSdkVersion = '35'
    minSdkVersion = '26'
    targetSdkVersion = '35'

    namespace = 'com.momosoftworks.prospect'

    // Permissions for camera and storage support
    permissions = [
            'android.permission.CAMERA',
            'android.permission.WRITE_EXTERNAL_STORAGE',
            'android.permission.READ_EXTERNAL_STORAGE'
    ]
}

application {
    mainClass = "com.momosoftworks.prospect.ProspectApplication"
    mainClassName = "com.momosoftworks.prospect.ProspectApplication"
}